---
  - name: Upgrade the OS
    apt:
      upgrade: dist
      update-cache: true

  - name: Add HashiCorp apt signing key
    apt_key:
      url: https://apt.releases.hashicorp.com/gpg
      state: present

  - name: Add HashiCorp apt Repo
    apt_repository:
      repo: "deb https://apt.releases.hashicorp.com {{ ansible_distribution_release }} main"
      state: present

  - name: Install base packages
    apt:
      pkg: 
      - zip
      - python3-pip
      - dnsmasq
      - jq
      - moreutils
      - awscli
      - ruby
      - consul={{consul_version}}
      - vault={{vault_version}}
      state: present
      update-cache: true